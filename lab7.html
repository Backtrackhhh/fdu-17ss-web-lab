<html>
<head>
    <title>Tables</title>
    <style>
        body {
            text-align: center;
        }
        #select, #commit, #nowTable {
            width: 300px;
        }
        table {
            margin: 0 auto;
        }
        th {
            background-color: grey;
            color: whitesmoke;
        }
        tr:nth-child(odd) td {
            background-color: lightgrey;
        }
        td {
            padding: 0 0.5em;
        }
    </style>
</head>
<body>
<form id="form">
    <select title="select" id="select">
        <option>SELECT ONE</option>
        <option>CREATE TABLE</option>
        <option>ADD ROW</option>
        <option>DELETE ROW</option>
        <option>DELETE TABLE</option>
    </select>
    <div id="content"></div>
    <input type="button" value="commit" id="commit">
</form>
<select title="nt" id="nowTable">
    <option>SELECT (default: last created)</option>
</select>
<div id="table"></div>


</body>


<script>

    let select1=document.getElementById("select");
    let select2=document.getElementById("nowTable");
    let content = document.getElementById("content");
    var inputtext = document.createElement('input');  //创建input节点
    var inputnum = document.createElement('input');  //创建input节点
    var input = document.createElement('input');  //创建input节点
    var inputbox = document.createElement("div");
    var tableshow = document.getElementById("table");
    inputbox.id="inputbox"
    var btn = document.getElementById("commit");
    inputtext.style.marginRight="10px";
    inputtext.setAttribute('type', 'text' );  //定义类型是文本输入
    inputtext.setAttribute('placeholder','Tablename' );
    inputnum.setAttribute('type', 'number');
    inputnum.setAttribute('placeholder','Columns' );
    // inputnum.setAttribute('id', 'txtnum');
    input.setAttribute('type', 'input');
    input.setAttribute('placeholder','Attribute' );
    btn.style.display="none";

    function isPositiveInteger(s){//是否为正整数
        var re = /^[0-9]+$/ ;
        return re.test(s)
    }

    select1.onchange = function(){
        switch (this.value) {
            case "SELECT ONE":
                btn.style.display="none";
                break;
            case "CREATE TABLE":
                document.getElementById('content').appendChild(inputtext ); //添加到form中显示
                // document.getElementById('content').appendChild(label );
                document.getElementById("content").appendChild(inputnum);

                inputnum.id="num"
                inputnum.onchange= function () {

                    let s = document.getElementById("num").value;
                    let columnsInput = []; if(isPositiveInteger(s)){
                        while(inputbox.hasChildNodes())
                        {
                            inputbox.removeChild(inputbox.firstChild);
                        }
                    for(let i = 0; i < s; i++){
                        columnsInput[i] = document.createElement("input");
                        columnsInput[i].type = "text";
                        columnsInput[i].placeholder =  "Attribute";
                        columnsInput[i].style.width = 300 + "px";
                        columnsInput[i].style.height = "20px";
                        inputbox.appendChild(columnsInput[i]);document.getElementById('content').appendChild(inputbox);
                        btn.style.display = "";
                    }
                }
        }
                break;

            case "ADD ROW":
                aboutTb.style.display = "none";
                aboutColumn.style.display = "block";
                addRow();
                infor.innerHTML = "";
                break;
            case "DELETE RPW":
                aboutTb.style.display = "none";
                aboutColumn.style.display = "block";
                if(select2.value !== "select")
                    showInput(tables[select2.value].getElementsByTagName("th").length,tables[select2.value].getElementsByTagName("th"));
                infor.innerHTML = "";
                break;
            case "DELETE TABLE":
                tbCreate.style.display = "none";
                infor.innerHTML = "WARNING: You cannot undo this action!";
                if(select2.value === "select"){
                    infor.innerHTML = '';
                }
                break;
        }
    };


select2.onchange = function(){
    showTable(tables[select2.value]);
    if(select2.value === "select")
        return;
    if(select1.value === "addRow" || select1.value === "delRow"){
        showInput(tables[select2.value].getElementsByTagName("th").length, numbers = tables[select2.value].getElementsByTagName("th"));
    }
};

//添加一行所显示的input



button.onclick = function(){
    if(select1.value === "CREATE TABLE"){
        var tables = new Array();
        var attrbutes = new Array();
        var names = tables[index].insertRow(0);
        let index = tables.length;
        tables[index] = document.createElement("table");
        tables[index].name = inputtext.value;
        var number = parseInt(inputnum.value);
        tables[index].num = parseInt(inputnum.value);
        //防止表格重复
        for (let i=1;i<=attrbutes.length-1;i++)
        {
            if (content == attributes[i].parentNode) input.removeChild(attributes[i]);
        }

        if (tableName.value==""||inputnum.value=="")
        {
            if (commitButton.style.display=="block") commitButton.style.display= "none";
            return;
        }
        attributes = new Array();
        commitButton.style.display="block";
        for (let i =1;i<=columnsNumbers;i++)
        {
            attributes[i] = document.createElement("input")
            attributes[i].placeholder = "Attribute";
            attributes[i].type = "text";
            input.appendChild(attributes[i]);
        }
        for (let i =0; i<number;i++) {
            let th = document.createElement("th");
            th.appendChild(document.createTextNode(attrbutes[i].value))
            names.appendChild(th);

        }
        tableshow.appendChild(tables[index]);
        let option=document.createElement("option");
        option.appendChild(document.createTextNode(inputtext.value));
        option.selected=true;
        select2.appendChild(option);
    }else if(select1.value === "addRow"){

    }else if(select1.value === "delRow"){


}};





   </script>
</html>
